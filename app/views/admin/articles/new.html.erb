<% if flash[:error] %>
  <div class="alert alert-error">
    <a class="close" data-dismiss="alert">×</a> 
    <p><%= flash[:error] %></p>
  </div>
  <% elsif flash[:notice] %>
  <div class="alert alert-success">
    <a class="close" data-dismiss="alert">×</a> 
    <p><%= flash[:notice] %></p>
  </div>
<% end %>

<div class='page-header'>
	<h2>New Article</h2>
</div>

<%= form_for(@article, :url=>"/admin/articles/new", :html=>{:class=>"form-horizontal"}, :method => "post") do |f| %>
  
  <%=f.hidden_field :id %>
  <div class="control-group">
    <label class="control-label" for="title">文章标题：</label>
    <div class="controls">
      <%= f.text_field :title, :class => "span5", :placeholder=>"请输入标题", :class=>"span5" %>
    </div>
  </div>

  <div class="control-group">
    <label class="control-label">文章分类：</label>
    <div class="controls">
      <% for category in @categories %>
      <label class="radio inline">
        <input type="radio" name="category_id" id="category_<%=category.id%>" value="<%=category.id%>">
        <%=category.name%>
      </label>
      <% end %>
    </div>
  </div>

  <div class="control-group">
    <div class="controls">
      <textarea rows="20" name="article[content]" class="span9"><%=@article.content%></textarea>
    </div>
  </div>

  <div class="control-group">
    <div class="controls">
      <button type="submit" class="btn" name="article[published]" value="0">保存草稿</button>
      <button type="submit" class="btn btn-primary" name="article[published]" value="1">发布</button>
    </div>
  </div>
<%end%>

<script type="text/javascript">
$(document).ready(function(){

  // 页面初始化时默认选中第一个category
  $("input:radio[name='category_id']")[0].checked = true;

  // 编辑时，选择文章所属的文章分类
  var category_id = "<%= @article.category_id %>";

  if (category_id != "") {
    $("#category_" + category_id)[0].checked = true;
  }
});
</script>